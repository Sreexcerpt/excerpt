const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FileSaver.min-D8LYF-Gj.js","assets/main-B8fsKJff.js","assets/main-DB0Zq_Dx.css"])))=>i.map(i=>d[i]);
import{r as d,j as e,a2 as je,a3 as ye,a4 as le,a5 as Ee,a1 as Se,a6 as A,a as ve,D as Te}from"./main-B8fsKJff.js";function de({firstName:I,CollegeName:N,FATHER_NAME:M,REG_NO:P,coursename:O,certificate_type:l,yop:F,coursecertificatr:V,Gender:j,Role:y,To:D,From:H,department:X,qualification:E}){console.log("Received props:",{firstName:I,CollegeName:N,FATHER_NAME:M,REG_NO:P,coursename:O,certificate_type:l,yop:F,Gender:j,Role:y,department:X,To:D,From:H,qualification:E});const K="/image/default.png",G=m=>{if(!m)return"";const h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],[R,o,U]=m.split("-");return`${parseInt(U)}-${h[parseInt(o)-1]}-${R}`},S=G(H),B=G(D),_=m=>`/image/${m}.jpg`,[ie,Z]=d.useState(""),ee=(m,h=!1)=>(h?m.toLowerCase():m).replace(/(?:^|\s|["'([{])+\S/g,R=>R.toUpperCase()),te=async()=>{const m=I?I.trim():"";if(m!==""&&l!==""&&E!=="")try{let h="";E.toUpperCase()==="BE"?l.toLowerCase()==="internship"?h="/BEINTERNSHIP.pdf":l.toLowerCase()==="project"&&(h="/BEPROJECT.pdf"):E.toUpperCase()==="DIPLOMA"&&(l.toLowerCase()==="internship"?h="/DIPLOMAINTERNSHIP.pdf":l.toLowerCase()==="project"&&(h="/DIPLOMAPROJECT.pdf"));const R=await fetch(h).then(s=>s.arrayBuffer()),o=await je.load(R);o.registerFontkit(ye);const U=await fetch("/fonts/Sanchez-Regular.ttf").then(s=>s.arrayBuffer()),g=await fetch("/fonts/NunitoSans_10pt-Bold.ttf").then(s=>s.arrayBuffer()),ae=await fetch("/fonts/NunitoSans_7pt_SemiExpanded-SemiBold.ttf").then(s=>s.arrayBuffer()),k=await o.embedFont(U),p=await o.embedFont(g),Y=await o.embedFont(ae),L=o.getPages()[0],{width:v,height:se}=L.getSize(),t="/image/1.png",i={BEINTERNSHIP:{width:150,height:80,x:"center",y:"top",topMargin:10,rightMargin:0},BEPROJECT:{width:180,height:70,x:"right",y:"top",topMargin:20,rightMargin:30},DIPLOMAINTERNSHIP:{width:150,height:60,x:"center",y:"top",topMargin:20,rightMargin:0,leftMargin:0},DIPLOMAPROJECT:{width:160,height:70,x:"center",y:"top",topMargin:50,rightMargin:0},IVCERTIFICATE:{width:170,height:75,x:"right",y:"top",topMargin:20,rightMargin:40},IVCERTIFICATE1:{width:180,height:70,x:"left",y:"top",topMargin:25,rightMargin:0,leftMargin:40},IVCERTIFICATE3:{width:210,height:95,x:"center",y:"top",topMargin:10,rightMargin:0},cert30:{width:180,height:80,x:"right",y:"top",topMargin:35,rightMargin:45}},$=E.toUpperCase()+(l?l.toUpperCase():""),n=i[$]||{width:200,height:90,x:"center",y:"top",topMargin:20,rightMargin:0};let T,J=se-n.height-n.topMargin;switch(n.x){case"center":T=(v-n.width)/2;break;case"right":T=v-n.width-n.rightMargin;break;case"left":T=n.leftMargin||50;break;default:T=(v-n.width)/2}try{const s=await fetch(t).then(w=>w.arrayBuffer());let r;const x=t.toLowerCase();if(x.endsWith(".png"))r=await o.embedPng(s);else if(x.endsWith(".jpg")||x.endsWith(".jpeg"))r=await o.embedJpg(s);else if(x.endsWith(".webp")){const w=new Blob([s],{type:"image/webp"}),u=await createImageBitmap(w),b=document.createElement("canvas");b.width=u.width,b.height=u.height,b.getContext("2d").drawImage(u,0,0);const q=b.toDataURL("image/png"),C=Uint8Array.from(atob(q.split("base64,")[1]),W=>W.charCodeAt(0));r=await o.embedPng(C)}else r=await o.embedPng(s);L.drawImage(r,{x:T,y:J,width:n.width,height:n.height})}catch(s){console.warn("Could not load logo, continuing without it:",s)}const a={BE:{internship:{name:{x:"center",y:340,fontSize:34},content:{x:110,y:305,fontSize:13.5,maxWidth:650,rightMargin:110,lineSpacing:22},qrCode:{x:295,y:77,width:80,height:70}},project:{name:{x:"center",y:370,fontSize:30},content:{x:130,y:330,fontSize:14,maxWidth:650,rightMargin:130,lineSpacing:22},qrCode:{x:290,y:50,width:100,height:90}}},DIPLOMA:{internship:{name:{x:"center",y:360,fontSize:32},content:{x:160,y:325,fontSize:13,maxWidth:620,rightMargin:160,lineSpacing:22},qrCode:{x:390,y:110,width:80,height:80}},project:{name:{x:"center",y:330,fontSize:30},content:{x:140,y:290,fontSize:13,maxWidth:620,rightMargin:140,lineSpacing:22},qrCode:{x:370,y:90,width:75,height:70}}}}[E.toUpperCase()][l.toLowerCase()],f=ee(m),he=k.widthOfTextAtSize(f,a.name.fontSize),ge=a.name.x==="center"?(v-he)/2:a.name.x;L.drawText(f,{x:ge,y:a.name.y,size:a.name.fontSize,font:k,color:le(0,0,0)});let Q="";l.toLowerCase()==="internship"?Q=j==="MALE"?`This is to certify that student from "${N}" has completed their internship work from ${S} to ${B} at Excerpt Technologies Private Limited.

He has successfully & satisfactorily completed assigned project work. During his tenure as a "${y}" we found him sincere, hardworking, and result-oriented.

We wish him great success in all of his future endeavors.`:`This is to certify that student from "${N}" has completed their internship work from ${S} to ${B} at Excerpt Technologies Private Limited.

She has successfully & satisfactorily completed assigned project work. During her tenure as a "${y}" we found her sincere, hardworking, and result-oriented.

We wish her great success in all of her future endeavors.`:l.toLowerCase()==="project"&&(Q=j==="MALE"?`This is to certify that student from ${N} has completed their project work from ${S} to ${B} at Excerpt Technologies Private Limited.

He has successfully & satisfactorily completed assigned project work. During his tenure as a ${y} we found him sincere, hardworking, and result-oriented.

We wish him great success in all of his future endeavors.`:`This is to certify that student from ${N} has completed their project work from ${S} to ${B} at Excerpt Technologies Private Limited.

She has successfully & satisfactorily completed assigned project work. During her tenure as a ${y} we found her sincere, hardworking, and result-oriented.

We wish her great success in all of her future endeavors.`);const ne=(s,r,x,w,u)=>{L.drawText(s,{x:r,y:x,size:w,font:u,color:le(0,0,0)})},pe=(s,r,x,w,u,b,oe)=>{const q=s.split(" ");let C="",W=x+5;for(let z=0;z<q.length;z++){const Ne=C===""?q[z]:" "+q[z],ce=C+Ne;b.widthOfTextAtSize(ce,u)>w&&C!==""?(ne(C,r,W,u,b),C=q[z],W-=oe):C=ce}return C&&ne(C,r,W,u,b),W};if(Q!==""){const s=Q.split(`
`);let r=a.content.y-10;const x=a.content.lineSpacing||20,w=10;for(const u of s){if(u.trim()===""){r-=w;continue}r=pe(u,a.content.x,r,a.content.maxWidth,a.content.fontSize,Y,x),r-=w}}const re=`https://www.excerptech.com/certificate.html?REG_NO=${P}`;Z(re);const me={color:{dark:"#000"},errorCorrectionLevel:"H",width:200,type:"png",transparent:!0},fe=await Ee.toDataURL(re,me),ue=Uint8Array.from(atob(fe.split("base64,")[1]),s=>s.charCodeAt(0)),xe=await o.embedPng(ue);L.drawImage(xe,{x:a.qrCode.x,y:a.qrCode.y,width:a.qrCode.width,height:a.qrCode.height});const we=await o.save(),Ce=new File([we],"Certificate.pdf",{type:"application/pdf;charset=utf-8"});typeof window<"u"&&(await Se(()=>import("./FileSaver.min-D8LYF-Gj.js").then(r=>r.F),__vite__mapDeps([0,1,2]))).default(Ce)}catch(h){console.error("Error generating or downloading certificate:",h),alert("Error generating or downloading certificate. Please try again later.")}else alert("Please enter a name, select a qualification, and select a certificate type.")};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"card shadow",children:[e.jsxs("div",{style:{textAlign:"justify"},children:[e.jsx("img",{className:"image",src:_(P)||K,alt:"Student"}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"NAME:"})," ",I]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"REG_NO:"})," ",P]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"FATHER_NAME:"})," ",M]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"COURSETITLE:"})," ",O]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"COOLEGENAME:"})," ",N]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"CERTIFICATION:"})," ",l]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"YOP:"})," ",F]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"COURSECERTIFICATION:"})," ",V]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"GENDER:"})," ",j]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"Role:"})," ",y]})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:te,style:{marginLeft:"-9px",width:"200px",marginTop:"10px"},children:"Get Certificate"}),e.jsx("a",{style:{marginLeft:"180px"},href:`https://www.excerptech.com/certificate.html?REG_NO=${P}`,target:"_blank",rel:"noopener noreferrer",children:"View Certificate"})]})]})})}de.propTypes={firstName:A.string.isRequired,REG_NO:A.string.isRequired,FATHER_NAME:A.string.isRequired,coursename:A.string.isRequired,CollegeName:A.string.isRequired,Course_Title:A.string.isRequired,certificate_type:A.string.isRequired,yop:A.string.isRequired};function be(){const[I,N]=d.useState([]),[M,P]=d.useState([]),[O,l]=d.useState(""),[F,V]=d.useState(""),[j,y]=d.useState(""),[D,H]=d.useState(""),[X,E]=d.useState([]),[K,G]=d.useState([]),[S,B]=d.useState(""),[_,ie]=d.useState("");d.useEffect(()=>{Z()},[]);const Z=async()=>{try{const t=await ve.get("http://localhost:8080/api/students");N(t.data),console.log("Fetched students:",t.data);const i=[...new Set(t.data.map(n=>n.college_name))],$=[...new Set(t.data.map(n=>n.yop))];E(i),G($)}catch(t){console.error("Error fetching data:",t)}};d.useEffect(()=>{U(O,F,S,_,j,D)},[I,O,F,S,_,j,D]),console.log("Filtered students:",M);const ee=t=>l(t.target.value),te=t=>V(t.target.value),m=t=>B(t.target.value),h=t=>ie(t.target.value),R=t=>y(t.target.value),o=t=>H(t.target.value),U=(t,i,$,n,T,J)=>{let c=[...I];if(t&&(c=c.filter(a=>a.college_name?.toLowerCase()===t.toLowerCase())),i&&(c=c.filter(a=>a.yop===i)),T&&(c=c.filter(a=>(a.qualification?.toLowerCase()||"")===T.toLowerCase())),J&&(c=c.filter(a=>(a.CERTIFICATION||a.certificate_type||"").toLowerCase()===J.toLowerCase())),$){const a=$.toLowerCase();c=c.filter(f=>f.NAME?.toLowerCase().includes(a)||f.REG_NO?.toLowerCase().includes(a)||f.FATHER_NAME?.toLowerCase().includes(a)||(f.COURSETITLE||f.coursename||"")?.toLowerCase().includes(a))}n&&(c=c.filter(a=>a.REG_NO===n)),c.sort((a,f)=>(a.NAME||"").localeCompare(f.NAME||"")),P(c)},[g,ae]=d.useState(1),k=6,p=Math.ceil(M.length/k),Y=(g-1)*k,L=M.slice(Y,Y+k),v=t=>{t>=1&&t<=p&&(ae(t),window.scrollTo({top:0,behavior:"smooth"}))},se=()=>{const t=[];if(p<=5)for(let i=1;i<=p;i++)t.push(i);else g<=3?t.push(1,2,3,4,"...",p):g>=p-2?t.push(1,"...",p-3,p-2,p-1,p):t.push(1,"...",g-1,g,g+1,"...",p);return t};return e.jsxs("div",{className:"col-9",children:[e.jsx("section",{className:"sub-header position-relative ",style:{height:"10vh"},children:e.jsxs("div",{className:"container d-flex justify-content-between align-items-center",children:[e.jsx("h2",{className:"heading-2 w-20",children:"Certificate"}),e.jsx("h6",{className:"heading-6 w-80 text-end",children:e.jsx("a",{href:"/dashboard",children:"dashboard"})})]})}),e.jsx("div",{className:"container",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-2",children:e.jsxs("select",{className:"form-select",value:O,onChange:ee,children:[e.jsx("option",{value:"",children:"College Name"}),X.map((t,i)=>e.jsx("option",{value:t,children:t},i))]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("select",{className:"form-select",value:F,onChange:te,children:[e.jsx("option",{value:"",children:"YOP"}),K.map((t,i)=>e.jsx("option",{value:t,children:t},i))]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("select",{className:"form-select",value:j,onChange:R,children:[e.jsx("option",{value:"",children:"Qualification"}),e.jsx("option",{value:"BE",children:"BE"}),e.jsx("option",{value:"Diploma",children:"Diploma"})]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("select",{className:"form-select",value:D,onChange:o,children:[e.jsx("option",{value:"",children:"Certificate Type"}),e.jsx("option",{value:"INTERNSHIP",children:"Internship"}),e.jsx("option",{value:"PROJECT",children:"Project"})]})}),e.jsx("div",{className:"col-md-2",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Search...",value:S,onChange:m})}),e.jsx("div",{className:"col-md-2",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Enter REG_NO...",value:_,onChange:h})})]})}),e.jsx("div",{className:"row",children:L.map((t,i)=>e.jsx("div",{className:"col-xl-4 col-md-4 col-sm-6 col-lg-4 mb-4",children:e.jsx(de,{firstName:t.NAME||"N/A",Gender:t.GENDER||"N/A",CollegeName:t.college_name||"N/A",FATHER_NAME:t.FATHER_NAME||"N/A",REG_NO:t.REG_NO||"N/A",coursename:t.COURSETITLE||t.coursename||"N/A",certificate_type:t.CERTIFICATION||t.certificate_type||"N/A",qualification:t.qualification||"Not Available",department:t.department||"Not Available",yop:t.yop||"N/A",coursecertificatr:t.COURSECERTIFICATION||t.Course_Certificate_Type||"N/A",Role:t.Role||"N/A",From:t.From||"N/A",To:t.To||"N/A"})},i))}),p>1&&e.jsxs("div",{className:"d-flex justify-content-center align-items-center mt-4 flex-wrap",children:[e.jsx("button",{style:{maxWidth:"100px"},className:"btn btn-secondary mx-2",disabled:g===1,onClick:()=>v(g-1),children:"◀ Prev"}),se().map((t,i)=>t==="..."?e.jsx("span",{className:"mx-2 text-muted",children:"..."},i):e.jsx("button",{style:{maxWidth:"3vw"},className:`btn btn-sm mx-1 ${g===t?"btn-primary":"btn-outline-primary"}`,onClick:()=>v(t),children:t},i)),e.jsx("button",{style:{maxWidth:"100px"},className:"btn btn-secondary mx-2",disabled:g===p,onClick:()=>v(g+1),children:"Next ▶"})]})]})}const Pe=()=>e.jsx("div",{children:e.jsxs("div",{className:"row",children:[e.jsx(Te,{}),e.jsx("div",{className:"col-8",children:e.jsx("div",{children:e.jsx(be,{})})})]})});export{Pe as default};
